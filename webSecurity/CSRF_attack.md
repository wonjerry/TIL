### CSRF 공격
Cross Site Request Forgery( 사이트간 요청 위조 )

이 공격 방법은 해커가 피싱을사용자에게 해서 웹사이트의 어떤 링크를 누르게 하고, 그 링크를 누르면 활용해 사용자가 모르게 어떤 기능을 실행시킨다.

주로 사용자의 패스워드를 변경해버리는 것들을 한다.

피싱은 이메일이나 게시판을 이용해서 대기업이나 유명 기업인척 해서 사람들을 낚는(fishing) 기법이다.

#### 과정
1. 사용자가 로그인
2. 해커가 이메일을 보내서 링크를 누르도록 피싱함
3. 링크를 클릭
4. 이미 로그인 되어있는 사이트에 패스워드 변경요청함
5. 해커는 변경된 패스워드로 해당 사용자에 로그인 할 수 있게된다.

#### 요청 분석
요청을 보면 대부분은 다 똑같은데 header 부분에 http_referer 부분이 일반적인 요청일 때는 localhost, 공격요청일 때는 127.0.0.1임을 볼 수 있다.

#### 대응 방법
1. 요청을 받을 때 요청의 http_referer가 제대로 되어있는지 확인한다.
	- 그런데 만약 해커가 해당 웹서버에서 요청을 보낸다면 확인할 수 없다.
	- 또한 만약 server 이름과 http-referer를 비교할 때 단순히 server 이름이 http-referer에 포함 되는지의 여부만 따진다면 그냥 피싱사이트에 해당 서비 이름을 포함하면 되기때문에 우회가 가능해진다.
	- 따라서 앞에서부터 해당 사이트의 주소가 진짜 맞는지 패턴 검사등등을 해서 좀 더 정확한 체크가 필요하다
2. 해당 페이지에 접근할 때 user token을 할당한다.
	- 서버에서 제공해주는 token을 사용하며, 이 token은 랜덤하게 바뀐다.
	- 하지만 이 방법도 우회가 가능하다.
	- 만약 첫 요청에서 token이 주어진다면 일단 javascript를 통해 받은 token을 추출하고, 그 token을 이용하여 비밀번호 변경 요청을 보낼 수 있다.
3. 원래 비밀번호를 입력하고, 그 다음에 바꿀 비밀번호를 입력하게 한다.
	- 이렇게 함으로써 해커가 이미 비밀번호를 알고있지 않은 이상 CSRF 공격이 불가능하게 된다.
	- 또는 capcha를 통해 실제 사용자가 요청을 수행했는지 확인한다.
