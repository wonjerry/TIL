### File upload attack
파일을 업로드 할 수 있는 페이지 (게시판, SNS)에 악성 파일(웹쉘 - 웹을통해 시스템 명령을 실행할 수 있는 것)을 업로드 하는 공격이다.

#### 과정
1. 이미지 업로드하는 페이지에서 웹쉘 파일을 업로드 한다.
2. 만약 서버에서 이것이 이미지인지 제대로 확인하지 않으면 서버에 해당 파일이 저장되게 된다.
3. 해커는 저장된 웹쉘을 실행시켜 명령어를 입력해서 서버를 장악한다.

#### 대응 방법
1. 이미지 파일인지 아닌지를 체크한다.
	- content type을 체크해서 이미지인지 아닌지를 체크하도록 한다.
	- 이렇게하면 forwarding을 통해서 php type을 image/jpeg로 간단하게 바꿔주기만 하면 그냥 아무문제없이 파일이 업로드되기 때문에 소용이 없다.
2.  파일 확장자가 jpg인지 jpeg인지 png인지 체크한다.
	- 그러나 이것도 우회가 가능하다.
	- filename 자체를 webshell.php.jpg로 변경하면 뚫릴 가능성이 크다.
	- 하지만 .php로 끝나야 webshell이 실행된다.
	- 파일 인클루젼 공격과 같이 사용하면 비록 확장자가 .jpg라도 실행시킬 수 있다.
	- page= "해당 파일의 경로"이렇게 입력 해주면 해당 파일이 브라우저에 render 되게 되고, 비록 jpg 라도 내용은 php이기 때문에 실행이 가능하다.
3. 이미지 파일임은 체크한 후에, 이미지 파일을 다시 생성해준다. 이렇게 함으로써 무늬만 jpg 파일인 것을 막을 수 있다.
4. 업로드 되는 파일 이름을 랜덤하게 생성한다.
5. 파일 서버와 웹서버를 분리한다.
