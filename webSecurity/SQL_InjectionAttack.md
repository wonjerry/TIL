### SQL injection attack
데이터에 전송되는 SQL 쿼리문을 조작하여 데이터를 변조하거나 허가되지 않은 정보에 접근하는 공격 방식이다.

#### 공격 방식
1. WHERE
	- ID가 1인 사용자가 요청을 보냄
	- 그러면 "SELECT name, email FROM users WHERE ID='1'" 이라는 쿼리문을 보내게 된다.
	- 이때 해커는 요청을 보낼 때 ID = 1' or '1'='1이라고 보낸다.
	- 그러면 쿼리문이 "SELECT name, email FROM users WHERE ID='1' or '1'='1'" 이렇게 변경되게 되는데 이때 ID가 1 또는 '1'='1' 즉 항상 true인 조건이 들어가기 때문에 모든 데이터를 해커에게 탈취당하게 된다.
	- 만약 비 정상적인 입력(' 등등)을 했을 때 DB 오류가 난다면 그 사이트는 SQL 쿼리문을 사용한다는 의미이며, SQL injection 공격이 매우 용이하다는 의미이다.
2. UNION
	- 좀전과 요청 및 결과는 같다.
	- 이번에 해커는 ID=1' union select name,pw from users# 이란 요청을 보내게 된다.
	- 그러면 DB로 보내는 쿼리문이 "SELECT name, email FROM users WHERE ID='1' union select name,pw from users#' 이렇게 구성된다.
	- union은 두개의 결과를 합하는 합집합의 의미이며, 원래 요청의 결과값인 name, email 뿐만아니라 name과 pw 정보까지 결과값에 포함되게 되며 결국 해커에게 데이터가 탈취당하게 된다.
	- #은 mysql에서 주석처리 키워드인데, 만약 쿼리문 뒤에 다른 것이 온다면 주석처리해서 해커가 원하는 데이터만 받아오게 한다.
	- union을 사용할 때  칼럼 개수를 알아야 데이터를 빼올 수 있는데, 이때 ORDER BY라는 키워드를 사용하면, 원래 칼럼 개수과 함께 현재 칼럼 개수가 작은지, 큰지를 알 수 있다.
3. Blind SQL injection
	- 만약 사이트에서 어떤 데이터 조회를 했을 때, 데이터베이스의 내용을 그대로 보여주지 않고 그냥 이 데이터는 있고 이 데이터는 없다 정도만 알 수 있다면 어떨까??
	- SELECT user from users where id='1' AND 1 = 1 이런식으로 하면 id가 1인 사용자가 있다면 true 없다면 false가 나옴으로써 해당 사용자가 있는지 없는지정도는 체크가 가능하다.
	- 그런데 만약 참 거짓 둘다 응답이 같다면, 어떻게 할까?? 이럴떄는 응답 시간의 차이를 줘서 알아낼 수도 있다.
		- sleep, waitfor와 같은 키워드로 참일때 응답을 늦게주게 하는 방법이 있다.
		- SELECT user from users where id='1' AND sleep(5)
		- 이런식으로 입력하면 앞이 참일 경우에만 AND 뒤가 실행되게 된다.
		- 하지만 이 방법은 엄청 오래걸리기 때문에 sql map과 같은 자동화 툴을 사용하면 좀 더 쉽게 알아낼 수 있다.
		- 이 툴은 어떤 사이트의 취약점을 찾아내고, 어떤 공격이 가능할지, 또한 자동화된 공격을 가능하게 도와준다.

#### 대응 방법
1. gui로 값을 선택하게 한다.
	- 하지만 요청 패킷을 탈취해서 값을 바꾸면 똑같이 동작하게 된다.
2. form을 새창에서 입력받는다.
	- 하지만 이것 또한 요청 패킷을 탈취해서 이전과 똑같이 처리할 수 있다.
	- 그리고 쿼리문 뒤에 limit 1을 해서 출력 데이터를 제한할 수 있다.
	- 그러나 이방법은 입력값 뒤롤 주석처리 하면 뚫린다.
3. 입력값을 확실히 검증한다.
	- 필요한 데이터 형태를 확실히 검사한다.
	- 숫자면 숫자, 문자열이면 문자열 패턴 또는 길이 제한 특수문자 제한 등등
	- 모든 인젝션 공격의 대응 방식은 입력값을 제대로 검증하는 것이다.
	- 이전에 보안에 취약한 레벨에서는 동적으로 쿼리문을 작성했지만 impossible 단계에서는 미리 쿼리문을 만들어두고, id 부분만 삽입해주는 방식으로 처리하여 우리의 입력은 sql문이 아닌 온전히 문자열로만 처리되어 추가적인 쿼리문이 실행되지 않도록 한다.
	- prepare 함수로 이러한 처리를 할 수 있으며 보안적인 프로그래밍을 위해서는 이러한 기능을 사용하는 것이 좋겠다.