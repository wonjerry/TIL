## 2017-12-9

오늘 한 공부
- chat simulator 만들어보기

chat simulator는 미리 저장되어 있는 chat 데이터를 읽어들여서 message를 띄우거나 누군가 접속시 접속 메세지를 띄운다거나 메시지를 삭제한다던가 수정한다던가 사용자 프로필을 수정하는 일을 시뮬레이션 하는 것이다.

어떻게 만들지 고민하다가 일단 메세지 데이터를 분석해서 메세지 타입이 어떤것이 있는지, 타입별로 어떤일을 해야하는지 파악하였다.

그후 ChatSimulation이라는 객체를 하나 만들고
1. chatdata중 하나의 packet이 들어오면 type을 판별해서 그 일을 하게끔 하는 packetHandler를 만들었다.
2. message 타입은 message cotainer안에 사용자의 닉네임, message 내용, 전송 시간을 띄워주었다.
3. update 타입은 message 내용을 업데이트하거나 사용자 데이터를 업데이트하는 두 종류가 있었다. message 내용을 업데이트 할 때는 dom에서 message id로 해당 element를 찾은 후 그 내용을 업데이트 시켰고 업데이트 내용 뒤에 (edited) 라고 붙여주었다., 사용자 데이터를 업데이트 하는 경우, 사용자 객체 내부에 updateInfo 메소드를 통해서 이름과 닉네임을 변경시켰다.
4. delete 타입은 그냥 dom element를 지우면 어떤게 지워졌는지 티가 안나서 system message로 어떤 id의 message를 지웠는지 띄워주고, 해당 message element를 찾아서 그 내용을 message deleted라고 변경시켜주었다. 변경시켜 줄 때 updateMessage 메소드를 활용하였다.
5. connect disconnect는 users 배열에 user를 넣거나 빼고, system message로 띄워주었다.

맨 처음에는 어떻게 짤지 고민을 좀 하다가 type을 좀 나눠서 일을 하게 하면 되겠다 라는 생각이 든 후 message 띄우기부터 진행 하니까 그 후론 착착 진행된 것 같다. 이모티콘을 띄운다거나 어떤 텍스트를 강조하는 기능, 접속한 친구를 보여주는 기능을 보여주면 좋겠다. 그리고 mvc 패턴을 배워서 적용시켜 보는 것도 좋을 것 같다.

나름 남이 봤을 때 역할이 명확하게 하기 위해서 메소드를 나누고 이름을 지었다. 그리고 각 메소드는 최대한 한가지 일만 하도록 만들었다.

항상 만들면서 고민하는 것 중 하나가 어떤 일을 하는 코드가 있을 때 그것이 단 한줄이라도 메소드로 만들어야 하는 것인데, 일단 기본 원칙은 반복적인 부분만 메소드로 만들고, 한줄짜리는 의미가 명확하다면 굳이 바꾸지 않는 것이다.

만약 반복적이지 않는데 함수로 만드는 경우는, 어떤 메소드가 매우 길 때, 그 긴 코드의 부분별로 무슨 일을 하는지 파악하기 쉽도록 하기 위해서 함수로 만들어 줄 수 있겠다.
